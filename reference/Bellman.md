# Compute Bellman values at step i from step i+1, used in `Grid_Matrix`

Compute Bellman values at step i from step i+1, used in `Grid_Matrix`

## Usage

``` r
Bellman(
  Data_week,
  next_week_values_l,
  decision_space,
  E_max,
  P_max = 0,
  mcyears,
  cvar_value = 1,
  niveau_max,
  states_steps,
  penalty_level_low,
  penalty_level_high,
  lvl_high,
  lvl_low,
  overflow_cost,
  next_state = NULL
)
```

## Arguments

- Data_week:

  A "data.table" generated in Grid_Matrix code that contains: \* states
  Numeric. All the water values that can be set, listed in decreasing
  order. \* value_inflow Numeric. Inflow values for each Monte-Carlo
  year. \* Rewards for each simulation value and each Monte-Carlo year.
  \* level_high Numeric. Highest possible reservoir value. \* level_low
  Numeric. Lowest possible reservoir value. \* states_next List of
  vectors enumerating all reachable states

- next_week_values_l:

  Numeric. Bellman values at step i+1.

- decision_space:

  Simulation constraints values

- E_max:

  Numeric of length 1. Maximum energy that can be generated by hydro
  storage over one step of time.

- P_max:

  Numeric of length 1. Maximum energy that can be pumped to reservoir
  over one step of time.

- mcyears:

  Vector. Monte Carlo years

- cvar_value:

  numeric in \[0,1\]. the probability used in cvar algorithm.

- niveau_max:

  Level max of the reservoir

- states_steps:

  Numeric. Discretization step of reservoir.

- penalty_level_low:

  Penalty for violating the bottom rule curve, comparable to the
  unsupplied energy

- penalty_level_high:

  Penalty for violating the top rule curve, comparable to the spilled
  energy

- lvl_high:

  Double. Upper rule curve for the considered week.

- lvl_low:

  Double. Bottom rule curve for the considered week.

- overflow_cost:

  Cost for overflow (equal to spillage cost of the area)

- next_state:

  possible states for next week

## Value

a `data.table` like Data_week with the Bellman values
